<!DOCTYPE html>
<html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>9 Computing Confusion Matrix | IMAP: Integrated Microbiome Analysis Pipelines</title>
<meta name="author" content="Teresia Mrema-Buza">
<meta name="description" content="A Confusion Matrix summarizes the performance of a classification model by tabulating the true positive, true negative, false positive, and false negative predictions. # Load necessary libraries...">
<meta name="generator" content="bookdown 0.39 with bs4_book()">
<meta property="og:title" content="9 Computing Confusion Matrix | IMAP: Integrated Microbiome Analysis Pipelines">
<meta property="og:type" content="book">
<meta property="og:url" content="https://tmbuza.github.io/imap-machine-learning/computing-confusion-matrix.html">
<meta property="og:image" content="https://tmbuza.github.io/imap-machine-learning/images/planning.png">
<meta property="og:description" content="A Confusion Matrix summarizes the performance of a classification model by tabulating the true positive, true negative, false positive, and false negative predictions. # Load necessary libraries...">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="9 Computing Confusion Matrix | IMAP: Integrated Microbiome Analysis Pipelines">
<meta name="twitter:description" content="A Confusion Matrix summarizes the performance of a classification model by tabulating the true positive, true negative, false positive, and false negative predictions. # Load necessary libraries...">
<meta name="twitter:image" content="https://tmbuza.github.io/imap-machine-learning/images/planning.png">
<!-- JS --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://kit.fontawesome.com/6ecbd6c532.js" crossorigin="anonymous"></script><script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="libs/bootstrap-4.6.0/bootstrap.min.css" rel="stylesheet">
<script src="libs/bootstrap-4.6.0/bootstrap.bundle.min.js"></script><link href="libs/Sen-0.4.9/font.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=DM%20Mono&amp;display=swap" rel="stylesheet">
<link href="libs/Bitter-0.4.9/font.css" rel="stylesheet">
<script src="libs/bs3compat-0.7.0/transition.js"></script><script src="libs/bs3compat-0.7.0/tabs.js"></script><script src="libs/bs3compat-0.7.0/bs3compat.js"></script><link href="libs/bs4_book-1.0.0/bs4_book.css" rel="stylesheet">
<script src="libs/bs4_book-1.0.0/bs4_book.js"></script><script src="libs/htmlwidgets-1.6.4/htmlwidgets.js"></script><script src="libs/d3-3.3.8/d3.min.js"></script><script src="libs/dagre-0.4.0/dagre-d3.min.js"></script><link href="libs/mermaid-0.3.0/dist/mermaid.css" rel="stylesheet">
<script src="libs/mermaid-0.3.0/dist/mermaid.slim.min.js"></script><link href="libs/DiagrammeR-styles-0.2/styles.css" rel="stylesheet">
<script src="libs/chromatography-0.1/chromatography.js"></script><script src="libs/DiagrammeR-binding-1.0.11/DiagrammeR.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- CSS --><style type="text/css">
    
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  </style>
<link rel="stylesheet" href="style.css">
</head>
<body data-spy="scroll" data-target="#toc">

<div class="container-fluid">
<div class="row">
  <header class="col-sm-12 col-lg-3 sidebar sidebar-book"><a class="sr-only sr-only-focusable" href="#content">Skip to main content</a>

    <div class="d-flex align-items-start justify-content-between">
      <h1>
        <a href="index.html" title="End-to-End Practical User Guides Using Integrated Approaches"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a>:
        <small class="text-muted">End-to-End Practical User Guides Using Integrated Approaches</small>
      </h1>
      <button class="btn btn-outline-primary d-lg-none ml-2 mt-1" type="button" data-toggle="collapse" data-target="#main-nav" aria-expanded="true" aria-controls="main-nav"><i class="fas fa-bars"></i><span class="sr-only">Show table of contents</span></button>
    </div>

    <div id="main-nav" class="collapse-lg">
      <form role="search">
        <input id="search" class="form-control" type="search" placeholder="Search" aria-label="Search">
</form>

      <nav aria-label="Table of contents"><h2>Table of contents</h2>
        <ul class="book-toc list-unstyled">
<li><a class="" href="index.html">IMAP-Part 10: Predictive Modeling Using Microbiome Data</a></li>
<li class="book-part">ML COMPONENTS</li>
<li><a class="" href="key-components-of-microbiome-machine-learning.html"><span class="header-section-number">1</span> Key Components of Microbiome Machine Learning</a></li>
<li class="book-part">ML FRAMEWORKS</li>
<li><a class="" href="ml-framework_R.html"><span class="header-section-number">2</span> Machine Learning Framework in R: From Data Acquisition to Model Deployment</a></li>
<li class="book-part">ML PROTOTYPES</li>
<li><a class="" href="machine-learning-prototypes-streamlining-microbiome-model-development-and-deployment.html"><span class="header-section-number">3</span> Machine Learning Prototypes: Streamlining Microbiome Model Development and Deployment</a></li>
<li class="book-part">MODEL DEVELOPMENT</li>
<li><a class="" href="exploratory-data-analysis-eda.html"><span class="header-section-number">4</span> Exploratory Data Analysis (EDA)</a></li>
<li><a class="" href="feature-engineering-1.html"><span class="header-section-number">5</span> Feature Engineering</a></li>
<li class="book-part">MODEL TRAINING</li>
<li><a class="" href="data-splitting.html"><span class="header-section-number">6</span> Data Splitting</a></li>
<li><a class="" href="model-fitting.html"><span class="header-section-number">7</span> Model Fitting</a></li>
<li><a class="" href="hyperparameter-tuning.html"><span class="header-section-number">8</span> Hyperparameter Tuning</a></li>
<li class="book-part">PERFORMANCE METRICS</li>
<li><a class="active" href="computing-confusion-matrix.html"><span class="header-section-number">9</span> Computing Confusion Matrix</a></li>
<li class="book-part">MODEL DEPLOYMENT</li>
<li><a class="" href="model-deployment.html"><span class="header-section-number">10</span> Model Deployment</a></li>
<li class="book-part">APPENDIX</li>
<li><a class="" href="modeling-ideas.html"><span class="header-section-number">A</span> Modeling Ideas</a></li>
<li><a class="" href="using-ml-helper-function.html"><span class="header-section-number">B</span> Using ML helper function</a></li>
<li><a class="" href="imap-github-repos.html"><span class="header-section-number">C</span> IMAP GitHub Repos</a></li>
<li><a class="" href="session-information.html"><span class="header-section-number">D</span> Session Information</a></li>
<li><a class="" href="references.html">References</a></li>
</ul>

        <div class="book-extra">
          <p><a id="book-repo" href="https://github.com/tmbuza/imap-machine-learning">View book source <i class="fas fa-air-freshener"></i></a></p>
        </div>
      </nav>
</div>
  </header><main class="col-sm-12 col-md-9 col-lg-7" id="content"><div id="computing-confusion-matrix" class="section level1" number="9">
<h1>
<span class="header-section-number">9</span> Computing Confusion Matrix<a class="anchor" aria-label="anchor" href="#computing-confusion-matrix"><i class="fas fa-link"></i></a>
</h1>
<p>A Confusion Matrix summarizes the performance of a classification model by tabulating the true positive, true negative, false positive, and false negative predictions.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="computing-confusion-matrix.html#cb30-1" tabindex="-1"></a><span class="co"># Load necessary libraries</span></span>
<span id="cb30-2"><a href="computing-confusion-matrix.html#cb30-2" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb30-3"><a href="computing-confusion-matrix.html#cb30-3" tabindex="-1"></a><span class="co"># Predict using the trained model</span></span>
<span id="cb30-4"><a href="computing-confusion-matrix.html#cb30-4" tabindex="-1"></a>predictions <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_regLogistic_cv, <span class="at">newdata =</span> test_data)</span>
<span id="cb30-5"><a href="computing-confusion-matrix.html#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="computing-confusion-matrix.html#cb30-6" tabindex="-1"></a><span class="co"># Compute confusion matrix</span></span>
<span id="cb30-7"><a href="computing-confusion-matrix.html#cb30-7" tabindex="-1"></a>confusion_matrix <span class="ot">&lt;-</span> caret<span class="sc">::</span><span class="fu">confusionMatrix</span>(predictions, test_data<span class="sc">$</span>target)</span>
<span id="cb30-8"><a href="computing-confusion-matrix.html#cb30-8" tabindex="-1"></a></span>
<span id="cb30-9"><a href="computing-confusion-matrix.html#cb30-9" tabindex="-1"></a><span class="fu">print</span>(confusion_matrix)</span>
<span id="cb30-10"><a href="computing-confusion-matrix.html#cb30-10" tabindex="-1"></a>Confusion Matrix and Statistics</span>
<span id="cb30-11"><a href="computing-confusion-matrix.html#cb30-11" tabindex="-1"></a></span>
<span id="cb30-12"><a href="computing-confusion-matrix.html#cb30-12" tabindex="-1"></a>          Reference</span>
<span id="cb30-13"><a href="computing-confusion-matrix.html#cb30-13" tabindex="-1"></a>Prediction AAM AFR</span>
<span id="cb30-14"><a href="computing-confusion-matrix.html#cb30-14" tabindex="-1"></a>       AAM  <span class="dv">19</span>   <span class="dv">3</span></span>
<span id="cb30-15"><a href="computing-confusion-matrix.html#cb30-15" tabindex="-1"></a>       AFR   <span class="dv">5</span>  <span class="dv">16</span></span>
<span id="cb30-16"><a href="computing-confusion-matrix.html#cb30-16" tabindex="-1"></a>                                         </span>
<span id="cb30-17"><a href="computing-confusion-matrix.html#cb30-17" tabindex="-1"></a>               Accuracy <span class="sc">:</span> <span class="fl">0.814</span>          </span>
<span id="cb30-18"><a href="computing-confusion-matrix.html#cb30-18" tabindex="-1"></a>                 <span class="dv">95</span>% CI <span class="sc">:</span> (<span class="fl">0.666</span>, <span class="fl">0.9161</span>)</span>
<span id="cb30-19"><a href="computing-confusion-matrix.html#cb30-19" tabindex="-1"></a>    No Information Rate <span class="sc">:</span> <span class="fl">0.5581</span>         </span>
<span id="cb30-20"><a href="computing-confusion-matrix.html#cb30-20" tabindex="-1"></a>    P<span class="sc">-</span>Value [Acc <span class="sc">&gt;</span> NIR] <span class="sc">:</span> <span class="fl">0.000393</span>       </span>
<span id="cb30-21"><a href="computing-confusion-matrix.html#cb30-21" tabindex="-1"></a>                                         </span>
<span id="cb30-22"><a href="computing-confusion-matrix.html#cb30-22" tabindex="-1"></a>                  Kappa <span class="sc">:</span> <span class="fl">0.6269</span>         </span>
<span id="cb30-23"><a href="computing-confusion-matrix.html#cb30-23" tabindex="-1"></a>                                         </span>
<span id="cb30-24"><a href="computing-confusion-matrix.html#cb30-24" tabindex="-1"></a> Mcnemar<span class="st">'s Test P-Value : 0.723674       </span></span>
<span id="cb30-25"><a href="computing-confusion-matrix.html#cb30-25" tabindex="-1"></a><span class="st">                                         </span></span>
<span id="cb30-26"><a href="computing-confusion-matrix.html#cb30-26" tabindex="-1"></a><span class="st">            Sensitivity : 0.7917         </span></span>
<span id="cb30-27"><a href="computing-confusion-matrix.html#cb30-27" tabindex="-1"></a><span class="st">            Specificity : 0.8421         </span></span>
<span id="cb30-28"><a href="computing-confusion-matrix.html#cb30-28" tabindex="-1"></a><span class="st">         Pos Pred Value : 0.8636         </span></span>
<span id="cb30-29"><a href="computing-confusion-matrix.html#cb30-29" tabindex="-1"></a><span class="st">         Neg Pred Value : 0.7619         </span></span>
<span id="cb30-30"><a href="computing-confusion-matrix.html#cb30-30" tabindex="-1"></a><span class="st">             Prevalence : 0.5581         </span></span>
<span id="cb30-31"><a href="computing-confusion-matrix.html#cb30-31" tabindex="-1"></a><span class="st">         Detection Rate : 0.4419         </span></span>
<span id="cb30-32"><a href="computing-confusion-matrix.html#cb30-32" tabindex="-1"></a><span class="st">   Detection Prevalence : 0.5116         </span></span>
<span id="cb30-33"><a href="computing-confusion-matrix.html#cb30-33" tabindex="-1"></a><span class="st">      Balanced Accuracy : 0.8169         </span></span>
<span id="cb30-34"><a href="computing-confusion-matrix.html#cb30-34" tabindex="-1"></a><span class="st">                                         </span></span>
<span id="cb30-35"><a href="computing-confusion-matrix.html#cb30-35" tabindex="-1"></a><span class="st">       '</span>Positive<span class="st">' Class : AAM            </span></span>
<span id="cb30-36"><a href="computing-confusion-matrix.html#cb30-36" tabindex="-1"></a><span class="st">                                         </span></span></code></pre></div>
<div id="accuracy" class="section level2" number="9.1">
<h2>
<span class="header-section-number">9.1</span> Accuracy<a class="anchor" aria-label="anchor" href="#accuracy"><i class="fas fa-link"></i></a>
</h2>
<p>Accuracy measures the proportion of correctly classified instances out of the total number of instances. While intuitive, accuracy may not be suitable for imbalanced datasets, where the majority class dominates the classification.</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="va">accuracy</span> <span class="op">&lt;-</span> <span class="va">confusion_matrix</span><span class="op">$</span><span class="va">overall</span><span class="op">[</span><span class="st">"Accuracy"</span><span class="op">]</span></span>
<span><span class="va">accuracy</span></span>
<span> <span class="va">Accuracy</span> </span>
<span><span class="fl">0.8139535</span> </span></code></pre></div>
</div>
<div id="precision-and-recall" class="section level2" number="9.2">
<h2>
<span class="header-section-number">9.2</span> Precision and Recall<a class="anchor" aria-label="anchor" href="#precision-and-recall"><i class="fas fa-link"></i></a>
</h2>
<p>Precision measures the proportion of correctly predicted positive instances out of all instances predicted as positive. Recall, also known as sensitivity, measures the proportion of correctly predicted positive instances out of all actual positive instances.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="va">precision</span> <span class="op">&lt;-</span> <span class="va">confusion_matrix</span><span class="op">$</span><span class="va">byClass</span><span class="op">[</span><span class="st">"Precision"</span><span class="op">]</span></span>
<span><span class="va">precision</span></span>
<span><span class="va">Precision</span> </span>
<span><span class="fl">0.8636364</span> </span></code></pre></div>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">recall</span> <span class="op">&lt;-</span> <span class="va">confusion_matrix</span><span class="op">$</span><span class="va">byClass</span><span class="op">[</span><span class="st">"Recall"</span><span class="op">]</span></span>
<span><span class="va">recall</span></span>
<span>   <span class="va">Recall</span> </span>
<span><span class="fl">0.7916667</span> </span></code></pre></div>
</div>
<div id="f1-score" class="section level2" number="9.3">
<h2>
<span class="header-section-number">9.3</span> F1 Score<a class="anchor" aria-label="anchor" href="#f1-score"><i class="fas fa-link"></i></a>
</h2>
<p>The F1 Score is the harmonic mean of precision and recall. It provides a balanced assessment of a classifier’s performance, considering both false positives and false negatives.</p>
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/topepo/caret/">caret</a></span><span class="op">)</span></span>
<span><span class="va">f1</span> <span class="op">&lt;-</span> <span class="va">confusion_matrix</span><span class="op">$</span><span class="va">byClass</span><span class="op">[</span><span class="st">"F1"</span><span class="op">]</span></span>
<span><span class="va">f1</span></span>
<span>      <span class="va">F1</span> </span>
<span><span class="fl">0.826087</span> </span></code></pre></div>
</div>
<div id="performance-metrics-dataframe" class="section level2" number="9.4">
<h2>
<span class="header-section-number">9.4</span> Performance metrics dataframe<a class="anchor" aria-label="anchor" href="#performance-metrics-dataframe"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="computing-confusion-matrix.html#cb35-1" tabindex="-1"></a><span class="co"># Create a data frame for model performance metrics</span></span>
<span id="cb35-2"><a href="computing-confusion-matrix.html#cb35-2" tabindex="-1"></a>performance_metrics <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb35-3"><a href="computing-confusion-matrix.html#cb35-3" tabindex="-1"></a>  <span class="at">Metric =</span> <span class="fu">c</span>(<span class="st">"Accuracy"</span>, <span class="st">"Precision"</span>, <span class="st">"Recall"</span>, <span class="st">"F1 Score"</span>),</span>
<span id="cb35-4"><a href="computing-confusion-matrix.html#cb35-4" tabindex="-1"></a>  <span class="at">Value =</span> <span class="fu">c</span>(accuracy, precision, recall, f1)</span>
<span id="cb35-5"><a href="computing-confusion-matrix.html#cb35-5" tabindex="-1"></a>)</span>
<span id="cb35-6"><a href="computing-confusion-matrix.html#cb35-6" tabindex="-1"></a></span>
<span id="cb35-7"><a href="computing-confusion-matrix.html#cb35-7" tabindex="-1"></a>performance_metrics</span>
<span id="cb35-8"><a href="computing-confusion-matrix.html#cb35-8" tabindex="-1"></a>             Metric     Value</span>
<span id="cb35-9"><a href="computing-confusion-matrix.html#cb35-9" tabindex="-1"></a>Accuracy   Accuracy <span class="fl">0.8139535</span></span>
<span id="cb35-10"><a href="computing-confusion-matrix.html#cb35-10" tabindex="-1"></a>Precision Precision <span class="fl">0.8636364</span></span>
<span id="cb35-11"><a href="computing-confusion-matrix.html#cb35-11" tabindex="-1"></a>Recall       Recall <span class="fl">0.7916667</span></span>
<span id="cb35-12"><a href="computing-confusion-matrix.html#cb35-12" tabindex="-1"></a>F1         F1 Score <span class="fl">0.8260870</span></span></code></pre></div>
</div>
<div id="visualize-model-performance-metrics" class="section level2" number="9.5">
<h2>
<span class="header-section-number">9.5</span> Visualize model performance metrics<a class="anchor" aria-label="anchor" href="#visualize-model-performance-metrics"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="va">performance_metrics</span>, <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">Metric</span>, y <span class="op">=</span> <span class="va">Value</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_bar.html">geom_bar</a></span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"identity"</span>, fill <span class="op">=</span> <span class="st">"steelblue"</span>, color <span class="op">=</span> <span class="st">"black"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Metric"</span>, y <span class="op">=</span> <span class="st">"Value"</span>, title <span class="op">=</span> <span class="st">"Model Performance Metrics"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/unnamed-chunk-32-1.png" width="672"></div>
</div>
<div id="roc-curve-and-auc-roc" class="section level2" number="9.6">
<h2>
<span class="header-section-number">9.6</span> ROC Curve and AUC-ROC<a class="anchor" aria-label="anchor" href="#roc-curve-and-auc-roc"><i class="fas fa-link"></i></a>
</h2>
<p>The ROC Curve plots the true positive rate (sensitivity) against the false positive rate (1 - specificity) at various threshold settings. It provides a visual representation of the classifier’s performance across different threshold levels. The Area Under the ROC Curve (AUC-ROC) quantifies the overall performance of the model in distinguishing between the positive and negative classes. A higher AUC-ROC value indicates better discrimination performance.</p>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://xrobin.github.io/pROC/">pROC</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://ggplot2.tidyverse.org">ggplot2</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Compute predicted probabilities</span></span>
<span><span class="va">predicted_probabilities</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">mod_regLogistic_cv</span>, newdata <span class="op">=</span> <span class="va">test_data</span>, type <span class="op">=</span> <span class="st">"prob"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Extract probabilities for the positive class</span></span>
<span><span class="va">positive_probabilities</span> <span class="op">&lt;-</span> <span class="va">predicted_probabilities</span><span class="op">$</span><span class="va">AAM</span></span>
<span></span>
<span><span class="co"># Compute ROC curve and AUC-ROC</span></span>
<span><span class="va">roc_curve</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/roc.html">roc</a></span><span class="op">(</span><span class="va">test_data</span><span class="op">$</span><span class="va">target</span>, <span class="va">positive_probabilities</span><span class="op">)</span></span>
<span><span class="va">auc_roc</span> <span class="op">&lt;-</span> <span class="fu">pROC</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/auc.html">auc</a></span><span class="op">(</span><span class="va">roc_curve</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Plot ROC curve with descriptive axis titles</span></span>
<span><span class="fu"><a href="https://rdrr.io/pkg/pROC/man/ggroc.html">ggroc</a></span><span class="op">(</span><span class="va">roc_curve</span>, color <span class="op">=</span> <span class="st">"steelblue"</span>, size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>title <span class="op">=</span> <span class="st">"Receiver Operating Characteristic (ROC) Curve"</span>,</span>
<span>       x <span class="op">=</span> <span class="st">"False Positive Rate (1 - Specificity)"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"True Positive Rate (Sensitivity)"</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_minimal</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/unnamed-chunk-34-1.png" width="672"></div>
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span></span>
<span><span class="co"># Print AUC-ROC</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/cat.html">cat</a></span><span class="op">(</span><span class="st">"AUC-ROC:"</span>, <span class="va">auc_roc</span><span class="op">)</span></span>
<span><span class="va">AUC</span><span class="op">-</span><span class="va">ROC</span><span class="op">:</span> <span class="fl">0.8552632</span></span></code></pre></div>
</div>
<div id="significant-genera-with-wilcox.test" class="section level2" number="9.7">
<h2>
<span class="header-section-number">9.7</span> Significant genera with <code>wilcox.test</code><a class="anchor" aria-label="anchor" href="#significant-genera-with-wilcox.test"><i class="fas fa-link"></i></a>
</h2>
<p>The Wilcoxon rank sum test, also known as the Mann-Whitney U test, is a nonparametric test used to assess whether two independent samples have different distributions. It is particularly useful when the assumptions of the t-test are not met, such as when the data is not normally distributed or when the sample sizes are small</p>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://purrr.tidyverse.org/">purrr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://dplyr.tidyverse.org">dplyr</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyr.tidyverse.org">tidyr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_genera</span> <span class="op">&lt;-</span> <span class="va">composite</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="op">-</span><span class="va">taxonomy</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">rel_abund</span><span class="op">~</span><span class="va">hyper</span>, data<span class="op">=</span><span class="va">.x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">tidy</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>p.adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method<span class="op">=</span><span class="st">"BH"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_genera</span> <span class="op">&lt;-</span> <span class="va">all_genera</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.001</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span><span class="op">(</span><span class="va">p.adjust</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">taxonomy</span>, <span class="va">p.value</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="view-distribution-of-significant-genera" class="section level2" number="9.8">
<h2>
<span class="header-section-number">9.8</span> View distribution of significant genera<a class="anchor" aria-label="anchor" href="#view-distribution-of-significant-genera"><i class="fas fa-link"></i></a>
</h2>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">composite</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">sig_genera</span>, by<span class="op">=</span><span class="st">"taxonomy"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rel_abund <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">rel_abund</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">20000</span><span class="op">)</span>,</span>
<span>         taxonomy <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">taxonomy</span>, <span class="st">"(.*)"</span>, <span class="st">"*\\1*"</span><span class="op">)</span>,</span>
<span>         taxonomy <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">taxonomy</span>, <span class="st">"\\*(.*)_unclassified\\*"</span>,</span>
<span>                                <span class="st">"Unclassified&lt;br&gt;*\\1*"</span><span class="op">)</span>,</span>
<span>         hyper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">hyper</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">rel_abund</span>, y<span class="op">=</span><span class="va">taxonomy</span>, color<span class="op">=</span><span class="va">hyper</span>, fill<span class="op">=</span><span class="va">hyper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="co"># geom_vline(xintercept = 100/10530, size=0.5, color="gray") +</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span>dodge.width <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                                              jitter.width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>              shape<span class="op">=</span><span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">median_hilow</span>, fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>conf.int<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>               geom<span class="op">=</span><span class="st">"pointrange"</span>,</span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>               color<span class="op">=</span><span class="st">"black"</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span><span class="cn">NULL</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">F</span>, <span class="cn">T</span><span class="op">)</span>,</span>
<span>                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"dodgerblue"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Hypertension"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span><span class="cn">NULL</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">F</span>, <span class="cn">T</span><span class="op">)</span>,</span>
<span>                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"dodgerblue"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Hypertension"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span> <span class="st">"Relative abundance (%)"</span>, y<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html">element_markdown</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/unnamed-chunk-36-1.png" width="672"></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"figures/significant_genera.tiff"</span>, width<span class="op">=</span><span class="fl">6</span>, height<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="significant-pathways" class="section level2" number="9.9">
<h2>
<span class="header-section-number">9.9</span> Significant pathways<a class="anchor" aria-label="anchor" href="#significant-pathways"><i class="fas fa-link"></i></a>
</h2>
<p>Compute the significant pathways using <code>wilcox.test</code>.</p>
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">all_metabopwy</span> <span class="op">&lt;-</span> <span class="va">metabo_composite</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/nest.html">nest</a></span><span class="op">(</span>data <span class="op">=</span> <span class="op">-</span><span class="va">metabopwy</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>test <span class="op">=</span> <span class="fu">purrr</span><span class="fu">::</span><span class="fu"><a href="https://purrr.tidyverse.org/reference/map.html">map</a></span><span class="op">(</span>.x<span class="op">=</span><span class="va">data</span>, <span class="op">~</span><span class="fu"><a href="https://rdrr.io/r/stats/wilcox.test.html">wilcox.test</a></span><span class="op">(</span><span class="va">rel_abund</span><span class="op">~</span><span class="va">hyper</span>, data<span class="op">=</span><span class="va">.x</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="va">tidy</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu">tidyr</span><span class="fu">::</span><span class="fu"><a href="https://tidyr.tidyverse.org/reference/unnest.html">unnest</a></span><span class="op">(</span><span class="va">test</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>p.adjust <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/p.adjust.html">p.adjust</a></span><span class="op">(</span><span class="va">p.value</span>, method<span class="op">=</span><span class="st">"BH"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">sig_metabopwy</span> <span class="op">&lt;-</span> <span class="va">all_metabopwy</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> </span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span><span class="op">(</span><span class="va">p.value</span> <span class="op">&lt;</span> <span class="fl">0.3</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span> <span class="co"># Typically, the best significant p-value is set at 0.05</span></span>
<span>  <span class="fu">dplyr</span><span class="fu">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/select.html">select</a></span><span class="op">(</span><span class="va">metabopwy</span>, <span class="va">p.value</span><span class="op">)</span></span></code></pre></div>
</div>
<div id="view-distribution-of-significant-metabolic-pathways" class="section level2" number="9.10">
<h2>
<span class="header-section-number">9.10</span> View distribution of significant metabolic pathways<a class="anchor" aria-label="anchor" href="#view-distribution-of-significant-metabolic-pathways"><i class="fas fa-link"></i></a>
</h2>
<ul>
<li>Compute the significant pathways, then</li>
<li>P-values or Adjusted P-values (p.adjust) can be used to measure the significance levels.</li>
<li>View the distribution of the significant pathways.</li>
</ul>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">metabo_composite</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate-joins.html">inner_join</a></span><span class="op">(</span><span class="va">sig_metabopwy</span>, by<span class="op">=</span><span class="st">"metabopwy"</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://dplyr.tidyverse.org/reference/mutate.html">mutate</a></span><span class="op">(</span>rel_abund <span class="op">=</span> <span class="fl">100</span> <span class="op">*</span> <span class="op">(</span><span class="va">rel_abund</span> <span class="op">+</span> <span class="fl">1</span><span class="op">/</span><span class="fl">20000</span><span class="op">)</span>,</span>
<span>         metabopwy <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">metabopwy</span>, <span class="st">"(.*)"</span>, <span class="st">"*\\1*"</span><span class="op">)</span>,</span>
<span>         metabopwy <span class="op">=</span> <span class="fu"><a href="https://stringr.tidyverse.org/reference/str_replace.html">str_replace</a></span><span class="op">(</span><span class="va">metabopwy</span>, <span class="st">"\\*(.*)_unclassified\\*"</span>,</span>
<span>                                <span class="st">"Unclassified&lt;br&gt;*\\1*"</span><span class="op">)</span>,</span>
<span>         hyper <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/factor.html">factor</a></span><span class="op">(</span><span class="va">hyper</span>, levels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">T</span>, <span class="cn">F</span><span class="op">)</span><span class="op">)</span><span class="op">)</span> <span class="op"><a href="https://magrittr.tidyverse.org/reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot</a></span><span class="op">(</span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/aes.html">aes</a></span><span class="op">(</span>x<span class="op">=</span><span class="va">rel_abund</span>, y<span class="op">=</span><span class="va">metabopwy</span>, color<span class="op">=</span><span class="va">hyper</span>, fill<span class="op">=</span><span class="va">hyper</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/geom_jitter.html">geom_jitter</a></span><span class="op">(</span>position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_jitterdodge.html">position_jitterdodge</a></span><span class="op">(</span>dodge.width <span class="op">=</span> <span class="fl">0.8</span>,</span>
<span>                                              jitter.width <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>              shape<span class="op">=</span><span class="fl">21</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/stat_summary.html">stat_summary</a></span><span class="op">(</span>fun.data <span class="op">=</span> <span class="va">median_hilow</span>, fun.args <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>conf.int<span class="op">=</span><span class="fl">0.5</span><span class="op">)</span>,</span>
<span>               geom<span class="op">=</span><span class="st">"pointrange"</span>,</span>
<span>               position <span class="op">=</span> <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/position_dodge.html">position_dodge</a></span><span class="op">(</span>width<span class="op">=</span><span class="fl">0.8</span><span class="op">)</span>,</span>
<span>               color<span class="op">=</span><span class="st">"black"</span>, show.legend <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_continuous.html">scale_x_log10</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_color_manual</a></span><span class="op">(</span><span class="cn">NULL</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">F</span>, <span class="cn">T</span><span class="op">)</span>,</span>
<span>                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"dodgerblue"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Hypertension"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/scale_manual.html">scale_fill_manual</a></span><span class="op">(</span><span class="cn">NULL</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="cn">F</span>, <span class="cn">T</span><span class="op">)</span>,</span>
<span>                     values <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"gray"</span>, <span class="st">"dodgerblue"</span><span class="op">)</span>,</span>
<span>                     labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"Control"</span>, <span class="st">"Hypertension"</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/labs.html">labs</a></span><span class="op">(</span>x<span class="op">=</span> <span class="st">"Relative abundance (%)"</span>, y<span class="op">=</span><span class="cn">NULL</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggtheme.html">theme_classic</a></span><span class="op">(</span><span class="op">)</span> <span class="op">+</span></span>
<span>  <span class="fu"><a href="https://ggplot2.tidyverse.org/reference/theme.html">theme</a></span><span class="op">(</span></span>
<span>    axis.text.y <span class="op">=</span> <span class="fu"><a href="https://wilkelab.org/ggtext/reference/element_markdown.html">element_markdown</a></span><span class="op">(</span><span class="op">)</span></span>
<span>  <span class="op">)</span></span></code></pre></div>
<div class="inline-figure"><img src="figures/unnamed-chunk-38-1.png" width="672"></div>
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span></span>
<span><span class="fu"><a href="https://ggplot2.tidyverse.org/reference/ggsave.html">ggsave</a></span><span class="op">(</span><span class="st">"figures/significant_genera.tiff"</span>, width<span class="op">=</span><span class="fl">6</span>, height<span class="op">=</span><span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<blockquote>
<p>Here we filter the metabolic pathways at a lesser stringent <code>p.values</code> (p &lt; 0.25) for demo purposes.</p>
</blockquote>
</div>
</div>



  <div class="chapter-nav">
<div class="prev"><a href="hyperparameter-tuning.html"><span class="header-section-number">8</span> Hyperparameter Tuning</a></div>
<div class="next"><a href="model-deployment.html"><span class="header-section-number">10</span> Model Deployment</a></div>
</div></main><div class="col-md-3 col-lg-2 d-none d-md-block sidebar sidebar-chapter">
    <nav id="toc" data-toggle="toc" aria-label="On this page"><h2>On this page</h2>
      <ul class="nav navbar-nav">
<li><a class="nav-link" href="#computing-confusion-matrix"><span class="header-section-number">9</span> Computing Confusion Matrix</a></li>
<li><a class="nav-link" href="#accuracy"><span class="header-section-number">9.1</span> Accuracy</a></li>
<li><a class="nav-link" href="#precision-and-recall"><span class="header-section-number">9.2</span> Precision and Recall</a></li>
<li><a class="nav-link" href="#f1-score"><span class="header-section-number">9.3</span> F1 Score</a></li>
<li><a class="nav-link" href="#performance-metrics-dataframe"><span class="header-section-number">9.4</span> Performance metrics dataframe</a></li>
<li><a class="nav-link" href="#visualize-model-performance-metrics"><span class="header-section-number">9.5</span> Visualize model performance metrics</a></li>
<li><a class="nav-link" href="#roc-curve-and-auc-roc"><span class="header-section-number">9.6</span> ROC Curve and AUC-ROC</a></li>
<li><a class="nav-link" href="#significant-genera-with-wilcox.test"><span class="header-section-number">9.7</span> Significant genera with wilcox.test</a></li>
<li><a class="nav-link" href="#view-distribution-of-significant-genera"><span class="header-section-number">9.8</span> View distribution of significant genera</a></li>
<li><a class="nav-link" href="#significant-pathways"><span class="header-section-number">9.9</span> Significant pathways</a></li>
<li><a class="nav-link" href="#view-distribution-of-significant-metabolic-pathways"><span class="header-section-number">9.10</span> View distribution of significant metabolic pathways</a></li>
</ul>

      <div class="book-extra">
        <ul class="list-unstyled">
<li><a id="book-source" href="https://github.com/tmbuza/imap-machine-learning/blob/gh-pages/01b_ml_realdata_prototypes.Rmd">View source <i class="fas fa-air-freshener"></i></a></li>
          <li><a id="book-edit" href="https://github.com/tmbuza/imap-machine-learning/edit/gh-pages/01b_ml_realdata_prototypes.Rmd">Edit this page <i class="fas fa-air-freshener"></i></a></li>
        </ul>
</div>
    </nav>
</div>

</div>
</div> <!-- .container -->

<footer class="bg-primary text-light mt-5"><div class="container">
    <div class="row">
      <div class="col-12 col-md-6 mt-3">
        <p><strong><u><a class="text-light" href="https://microbiome.complexdatainsights.com"><big>IMAP:</big> Integrated Microbiome Analysis Pipelines</a></u></strong>: End-to-End Practical User Guides Using Integrated Approaches</p>
<br><p>Authored by Teresia Mrema-Buza, Last updated: <b>2024-05-02</b>.</p>
<br>
</div>
      <div class="col-12 col-md-6 mt-3">
        <p>Note: This practical guide was created using the <a class="text-light" href="https://bookdown.org/yihui/bookdown/">bookdown</a> R package, styled with the modern bs4_book format.</p>
      </div>

    </div>
  </div>
</footer>
</body>
</html>
